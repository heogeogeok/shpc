[2024-12-14 00:20:18,544] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-12-14 00:20:18,549] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-12-14 00:20:18,553] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-12-14 00:20:18,553] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-12-14 00:20:18,558] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-12-14 00:20:18,568] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-12-14 00:20:18,568] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-12-14 00:20:18,570] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Warning: The cache directory for DeepSpeed Triton autotune, /home/s0/shpc152/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Warning: The cache directory for DeepSpeed Triton autotune, /home/s0/shpc152/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Warning: The cache directory for DeepSpeed Triton autotune, /home/s0/shpc152/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Warning: The cache directory for DeepSpeed Triton autotune, /home/s0/shpc152/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Warning: The cache directory for DeepSpeed Triton autotune, /home/s0/shpc152/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Warning: The cache directory for DeepSpeed Triton autotune, /home/s0/shpc152/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Warning: The cache directory for DeepSpeed Triton autotune, /home/s0/shpc152/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Warning: The cache directory for DeepSpeed Triton autotune, /home/s0/shpc152/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
[2024-12-14 00:20:54,186] [INFO] [comm.py:652:init_distributed] cdb=None
[2024-12-14 00:20:54,196] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:20:54,233] [INFO] [comm.py:652:init_distributed] cdb=None
[2024-12-14 00:20:54,236] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:20:54,240] [INFO] [comm.py:652:init_distributed] cdb=None
[2024-12-14 00:20:54,240] [INFO] [comm.py:683:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-12-14 00:20:54,246] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed info: version=0.16.0, git-hash=unknown, git-branch=unknown
[2024-12-14 00:20:54,246] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:20:54,389] [INFO] [comm.py:652:init_distributed] cdb=None
[2024-12-14 00:20:54,393] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:20:54,437] [INFO] [comm.py:652:init_distributed] cdb=None
[2024-12-14 00:20:54,443] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:20:54,480] [INFO] [comm.py:652:init_distributed] cdb=None
[2024-12-14 00:20:54,488] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:20:54,548] [INFO] [comm.py:652:init_distributed] cdb=None
[2024-12-14 00:20:54,553] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:20:54,834] [INFO] [comm.py:652:init_distributed] cdb=None
[2024-12-14 00:20:54,845] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:20:59,724] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /home/s0/shpc152/.cache/torch_extensions/py38_cu118 as PyTorch extensions root...
Using /home/s0/shpc152/.cache/torch_extensions/py38_cu118 as PyTorch extensions root...
Using /home/s0/shpc152/.cache/torch_extensions/py38_cu118 as PyTorch extensions root...
Using /home/s0/shpc152/.cache/torch_extensions/py38_cu118 as PyTorch extensions root...
Using /home/s0/shpc152/.cache/torch_extensions/py38_cu118 as PyTorch extensions root...
Using /home/s0/shpc152/.cache/torch_extensions/py38_cu118 as PyTorch extensions root...
Using /home/s0/shpc152/.cache/torch_extensions/py38_cu118 as PyTorch extensions root...
Using /home/s0/shpc152/.cache/torch_extensions/py38_cu118 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/s0/shpc152/.cache/torch_extensions/py38_cu118/fused_adam/build.ninja...
/usr/local/lib/python3.8/dist-packages/torch/utils/cpp_extension.py:1965: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.3139190673828125 seconds
Loading extension module fused_adam...
Time to load fused_adam op: 0.30388665199279785 seconds
Loading extension module fused_adam...
Time to load fused_adam op: 0.31362009048461914 seconds
Loading extension module fused_adam...
Time to load fused_adam op: 0.4047272205352783 seconds
[2024-12-14 00:21:01,291] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2024-12-14 00:21:01,292] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-12-14 00:21:01,356] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-12-14 00:21:01,356] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2024-12-14 00:21:01,356] [INFO] [logging.py:128:log_dist] [Rank 0] Creating fp16 ZeRO stage 3 optimizer, MiCS is enabled False, Hierarchical params gather False
[2024-12-14 00:21:01,356] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float32 ZeRO stage 3 optimizer
[2024-12-14 00:21:01,367] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:21:01,373] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:21:01,399] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:21:01,534] [INFO] [utils.py:781:see_memory_usage] Stage 3 initialize beginning
[2024-12-14 00:21:01,535] [INFO] [utils.py:782:see_memory_usage] MA 2.99 GB         Max_MA 2.99 GB         CA 3.06 GB         Max_CA 3 GB 
[2024-12-14 00:21:01,535] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 16.99 GB, percent = 3.4%
[2024-12-14 00:21:01,536] [INFO] [stage3.py:167:__init__] Reduce bucket size 500000000
[2024-12-14 00:21:01,536] [INFO] [stage3.py:168:__init__] Prefetch bucket size 50000000
[2024-12-14 00:21:01,662] [INFO] [utils.py:781:see_memory_usage] DeepSpeedZeRoOffload initialize [begin]
[2024-12-14 00:21:01,663] [INFO] [utils.py:782:see_memory_usage] MA 2.99 GB         Max_MA 2.99 GB         CA 3.06 GB         Max_CA 3 GB 
[2024-12-14 00:21:01,663] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 16.99 GB, percent = 3.4%
[2024-12-14 00:21:01,668] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
Loading extension module fused_adam...
Time to load fused_adam op: 3.011762857437134 seconds
[2024-12-14 00:21:02,845] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
Loading extension module fused_adam...Loading extension module fused_adam...

Time to load fused_adam op: 3.108766555786133 seconds
Time to load fused_adam op: 3.112471103668213 seconds
Loading extension module fused_adam...
Time to load fused_adam op: 3.1097145080566406 seconds
[2024-12-14 00:21:02,932] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:21:02,944] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
[2024-12-14 00:21:02,956] [INFO] [config.py:733:__init__] Config mesh_device None world_size = 8
Parameter Offload: Total persistent parameters: 601600 in 290 params
[2024-12-14 00:21:04,351] [INFO] [utils.py:781:see_memory_usage] DeepSpeedZeRoOffload initialize [end]
[2024-12-14 00:21:04,353] [INFO] [utils.py:782:see_memory_usage] MA 0.4 GB         Max_MA 3.02 GB         CA 3.13 GB         Max_CA 3 GB 
[2024-12-14 00:21:04,353] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 17.37 GB, percent = 3.5%
[2024-12-14 00:21:04,861] [INFO] [utils.py:781:see_memory_usage] Before creating fp16 partitions
[2024-12-14 00:21:04,869] [INFO] [utils.py:782:see_memory_usage] MA 0.4 GB         Max_MA 0.4 GB         CA 3.13 GB         Max_CA 3 GB 
[2024-12-14 00:21:04,869] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 17.37 GB, percent = 3.5%
[2024-12-14 00:21:05,983] [INFO] [utils.py:781:see_memory_usage] After creating fp16 partitions: 1
[2024-12-14 00:21:05,985] [INFO] [utils.py:782:see_memory_usage] MA 0.4 GB         Max_MA 0.4 GB         CA 0.4 GB         Max_CA 3 GB 
[2024-12-14 00:21:05,985] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 17.38 GB, percent = 3.5%
[2024-12-14 00:21:06,154] [INFO] [utils.py:781:see_memory_usage] Before creating fp32 partitions
[2024-12-14 00:21:06,155] [INFO] [utils.py:782:see_memory_usage] MA 0.4 GB         Max_MA 0.4 GB         CA 0.4 GB         Max_CA 0 GB 
[2024-12-14 00:21:06,156] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 17.38 GB, percent = 3.5%
[2024-12-14 00:21:06,324] [INFO] [utils.py:781:see_memory_usage] After creating fp32 partitions
[2024-12-14 00:21:06,326] [INFO] [utils.py:782:see_memory_usage] MA 0.76 GB         Max_MA 0.76 GB         CA 0.76 GB         Max_CA 1 GB 
[2024-12-14 00:21:06,326] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 17.38 GB, percent = 3.5%
[2024-12-14 00:21:06,494] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2024-12-14 00:21:06,495] [INFO] [utils.py:782:see_memory_usage] MA 0.76 GB         Max_MA 0.76 GB         CA 0.76 GB         Max_CA 1 GB 
[2024-12-14 00:21:06,495] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 17.38 GB, percent = 3.5%
[2024-12-14 00:21:06,664] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2024-12-14 00:21:06,665] [INFO] [utils.py:782:see_memory_usage] MA 0.76 GB         Max_MA 1.12 GB         CA 1.12 GB         Max_CA 1 GB 
[2024-12-14 00:21:06,665] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 17.38 GB, percent = 3.5%
[2024-12-14 00:21:06,666] [INFO] [stage3.py:525:_setup_for_real_optimizer] optimizer state initialized
[2024-12-14 00:21:08,047] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2024-12-14 00:21:08,049] [INFO] [utils.py:782:see_memory_usage] MA 2.98 GB         Max_MA 3.46 GB         CA 3.47 GB         Max_CA 3 GB 
[2024-12-14 00:21:08,049] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 17.38 GB, percent = 3.5%
[2024-12-14 00:21:08,049] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer_Stage3
[2024-12-14 00:21:08,049] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2024-12-14 00:21:08,050] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-12-14 00:21:08,050] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0001], mom=[(0.9, 0.999)]
[2024-12-14 00:21:08,052] [INFO] [config.py:999:print] DeepSpeedEngine configuration:
[2024-12-14 00:21:08,052] [INFO] [config.py:1003:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-12-14 00:21:08,052] [INFO] [config.py:1003:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2024-12-14 00:21:08,053] [INFO] [config.py:1003:print]   amp_enabled .................. False
[2024-12-14 00:21:08,053] [INFO] [config.py:1003:print]   amp_params ................... False
[2024-12-14 00:21:08,053] [INFO] [config.py:1003:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-12-14 00:21:08,053] [INFO] [config.py:1003:print]   bfloat16_enabled ............. False
[2024-12-14 00:21:08,053] [INFO] [config.py:1003:print]   bfloat16_immediate_grad_update  False
[2024-12-14 00:21:08,053] [INFO] [config.py:1003:print]   checkpoint_parallel_write_pipeline  False
[2024-12-14 00:21:08,053] [INFO] [config.py:1003:print]   checkpoint_tag_validation_enabled  True
[2024-12-14 00:21:08,053] [INFO] [config.py:1003:print]   checkpoint_tag_validation_fail  False
[2024-12-14 00:21:08,053] [INFO] [config.py:1003:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x152f803d9be0>
[2024-12-14 00:21:08,054] [INFO] [config.py:1003:print]   communication_data_type ...... None
[2024-12-14 00:21:08,054] [INFO] [config.py:1003:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-12-14 00:21:08,054] [INFO] [config.py:1003:print]   curriculum_enabled_legacy .... False
[2024-12-14 00:21:08,054] [INFO] [config.py:1003:print]   curriculum_params_legacy ..... False
[2024-12-14 00:21:08,054] [INFO] [config.py:1003:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-12-14 00:21:08,054] [INFO] [config.py:1003:print]   data_efficiency_enabled ...... False
[2024-12-14 00:21:08,054] [INFO] [config.py:1003:print]   dataloader_drop_last ......... False
[2024-12-14 00:21:08,054] [INFO] [config.py:1003:print]   disable_allgather ............ False
[2024-12-14 00:21:08,054] [INFO] [config.py:1003:print]   dump_state ................... False
[2024-12-14 00:21:08,054] [INFO] [config.py:1003:print]   dynamic_loss_scale_args ...... None
[2024-12-14 00:21:08,054] [INFO] [config.py:1003:print]   eigenvalue_enabled ........... False
[2024-12-14 00:21:08,054] [INFO] [config.py:1003:print]   eigenvalue_gas_boundary_resolution  1
[2024-12-14 00:21:08,055] [INFO] [config.py:1003:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-12-14 00:21:08,055] [INFO] [config.py:1003:print]   eigenvalue_layer_num ......... 0
[2024-12-14 00:21:08,055] [INFO] [config.py:1003:print]   eigenvalue_max_iter .......... 100
[2024-12-14 00:21:08,055] [INFO] [config.py:1003:print]   eigenvalue_stability ......... 1e-06
[2024-12-14 00:21:08,055] [INFO] [config.py:1003:print]   eigenvalue_tol ............... 0.01
[2024-12-14 00:21:08,055] [INFO] [config.py:1003:print]   eigenvalue_verbose ........... False
[2024-12-14 00:21:08,055] [INFO] [config.py:1003:print]   elasticity_enabled ........... False
[2024-12-14 00:21:08,055] [INFO] [config.py:1003:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-12-14 00:21:08,055] [INFO] [config.py:1003:print]   fp16_auto_cast ............... None
[2024-12-14 00:21:08,055] [INFO] [config.py:1003:print]   fp16_enabled ................. False
[2024-12-14 00:21:08,055] [INFO] [config.py:1003:print]   fp16_master_weights_and_gradients  False
[2024-12-14 00:21:08,055] [INFO] [config.py:1003:print]   global_rank .................. 0
[2024-12-14 00:21:08,056] [INFO] [config.py:1003:print]   grad_accum_dtype ............. None
[2024-12-14 00:21:08,056] [INFO] [config.py:1003:print]   gradient_accumulation_steps .. 1
[2024-12-14 00:21:08,056] [INFO] [config.py:1003:print]   gradient_clipping ............ 0.0
[2024-12-14 00:21:08,056] [INFO] [config.py:1003:print]   gradient_predivide_factor .... 1.0
[2024-12-14 00:21:08,056] [INFO] [config.py:1003:print]   graph_harvesting ............. False
[2024-12-14 00:21:08,056] [INFO] [config.py:1003:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-12-14 00:21:08,056] [INFO] [config.py:1003:print]   initial_dynamic_scale ........ 65536
[2024-12-14 00:21:08,056] [INFO] [config.py:1003:print]   load_universal_checkpoint .... False
[2024-12-14 00:21:08,056] [INFO] [config.py:1003:print]   loss_scale ................... 0
[2024-12-14 00:21:08,056] [INFO] [config.py:1003:print]   memory_breakdown ............. False
[2024-12-14 00:21:08,056] [INFO] [config.py:1003:print]   mics_hierarchial_params_gather  False
[2024-12-14 00:21:08,056] [INFO] [config.py:1003:print]   mics_shard_size .............. -1
[2024-12-14 00:21:08,057] [INFO] [config.py:1003:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2024-12-14 00:21:08,057] [INFO] [config.py:1003:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-12-14 00:21:08,057] [INFO] [config.py:1003:print]   optimizer_legacy_fusion ...... False
[2024-12-14 00:21:08,057] [INFO] [config.py:1003:print]   optimizer_name ............... adam
[2024-12-14 00:21:08,057] [INFO] [config.py:1003:print]   optimizer_params ............. {'lr': 0.0001}
[2024-12-14 00:21:08,057] [INFO] [config.py:1003:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-12-14 00:21:08,057] [INFO] [config.py:1003:print]   pld_enabled .................. False
[2024-12-14 00:21:08,057] [INFO] [config.py:1003:print]   pld_params ................... False
[2024-12-14 00:21:08,057] [INFO] [config.py:1003:print]   prescale_gradients ........... False
[2024-12-14 00:21:08,057] [INFO] [config.py:1003:print]   scheduler_name ............... None
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   scheduler_params ............. None
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   seq_parallel_communication_data_type  torch.float32
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   sparse_attention ............. None
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   sparse_gradients_enabled ..... False
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   steps_per_print .............. None
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   timers_config ................ enabled=True synchronized=True
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   train_batch_size ............. 64
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   train_micro_batch_size_per_gpu  8
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   use_data_before_expert_parallel_  False
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   use_node_local_storage ....... False
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   wall_clock_breakdown ......... False
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   weight_quantization_config ... None
[2024-12-14 00:21:08,058] [INFO] [config.py:1003:print]   world_size ................... 8
[2024-12-14 00:21:08,059] [INFO] [config.py:1003:print]   zero_allow_untested_optimizer  False
[2024-12-14 00:21:08,059] [INFO] [config.py:1003:print]   zero_config .................. stage=3 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-12-14 00:21:08,059] [INFO] [config.py:1003:print]   zero_enabled ................. True
[2024-12-14 00:21:08,059] [INFO] [config.py:1003:print]   zero_force_ds_cpu_optimizer .. True
[2024-12-14 00:21:08,059] [INFO] [config.py:1003:print]   zero_optimization_stage ...... 3
[2024-12-14 00:21:08,059] [INFO] [config.py:989:print_user_config]   json = {
    "train_batch_size": 64, 
    "zero_optimization": {
        "stage": 3, 
        "contiguous_gradients": true, 
        "reduce_bucket_size": 5.000000e+08, 
        "sub_group_size": 1.000000e+09
    }, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.0001
        }
    }
}
Epoch 1, Step 1, Loss: 10.034624099731445
Step 1 Timing: Forward: 4.3907s, Backward: 4.9380s, Optimizer: 0.1469s, Total: 9.4756s
Epoch 1, Step 2, Loss: 1.3594419956207275
Step 2 Timing: Forward: 4.4404s, Backward: 3.5766s, Optimizer: 0.1629s, Total: 8.1799s
[2024-12-14 00:21:31,646] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 3, Loss: 1.0777302980422974
Step 3 Timing: Forward: 1.4571s, Backward: 2.7554s, Optimizer: 0.2182s, Total: 4.4307s
[2024-12-14 00:21:37,164] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 4, Loss: 1.193162441253662
Step 4 Timing: Forward: 1.7097s, Backward: 3.4417s, Optimizer: 0.1910s, Total: 5.3424s
[2024-12-14 00:21:42,367] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 5, Loss: 0.0001268967316718772
Step 5 Timing: Forward: 1.5898s, Backward: 3.2672s, Optimizer: 0.1686s, Total: 5.0257s
[2024-12-14 00:21:46,659] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 6, Loss: 0.00011482949776109308
Step 6 Timing: Forward: 1.6534s, Backward: 2.3133s, Optimizer: 0.1406s, Total: 4.1074s
[2024-12-14 00:21:51,679] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 7, Loss: 1.3036988973617554
Step 7 Timing: Forward: 1.5146s, Backward: 3.1502s, Optimizer: 0.1802s, Total: 4.8450s
[2024-12-14 00:21:55,967] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 8, Loss: 0.15623004734516144
Step 8 Timing: Forward: 1.4992s, Backward: 2.3956s, Optimizer: 0.2119s, Total: 4.1067s
[2024-12-14 00:22:00,976] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 9, Loss: 1.5545092821121216
Step 9 Timing: Forward: 1.6112s, Backward: 2.9058s, Optimizer: 0.3109s, Total: 4.8280s
[2024-12-14 00:22:05,973] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 10, Loss: 0.6763911843299866
Step 10 Timing: Forward: 1.5272s, Backward: 3.1529s, Optimizer: 0.1373s, Total: 4.8174s
[2024-12-14 00:22:11,091] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 11, Loss: 0.5989281535148621
Step 11 Timing: Forward: 1.6052s, Backward: 3.0795s, Optimizer: 0.2566s, Total: 4.9413s
[2024-12-14 00:22:15,956] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 12, Loss: 0.0001468685659347102
Step 12 Timing: Forward: 1.5148s, Backward: 3.0274s, Optimizer: 0.1441s, Total: 4.6864s
[2024-12-14 00:22:20,629] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 13, Loss: 1.0252633094787598
Step 13 Timing: Forward: 1.6252s, Backward: 2.7005s, Optimizer: 0.1867s, Total: 4.5124s
[2024-12-14 00:22:25,682] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 14, Loss: 4.333041667938232
Step 14 Timing: Forward: 1.7039s, Backward: 2.9536s, Optimizer: 0.2162s, Total: 4.8737s
[2024-12-14 00:22:30,853] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 15, Loss: 0.13104180991649628
Step 15 Timing: Forward: 1.7076s, Backward: 3.1026s, Optimizer: 0.2131s, Total: 5.0233s
[2024-12-14 00:22:35,400] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 16, Loss: 0.08355762809515
Step 16 Timing: Forward: 1.5589s, Backward: 2.6060s, Optimizer: 0.2058s, Total: 4.3707s
[2024-12-14 00:22:40,341] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 17, Loss: 0.12882916629314423
Step 17 Timing: Forward: 1.7027s, Backward: 2.9324s, Optimizer: 0.1455s, Total: 4.7806s
[2024-12-14 00:22:45,216] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 18, Loss: 3.3242275714874268
Step 18 Timing: Forward: 1.5594s, Backward: 2.9951s, Optimizer: 0.1418s, Total: 4.6964s
[2024-12-14 00:22:50,540] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 19, Loss: 1.3598930835723877
Step 19 Timing: Forward: 1.6676s, Backward: 3.3230s, Optimizer: 0.1991s, Total: 5.1898s
[2024-12-14 00:22:56,078] [WARNING] [stage3.py:2118:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
Epoch 1, Step 20, Loss: 0.09713275730609894
Step 20 Timing: Forward: 1.7849s, Backward: 3.2437s, Optimizer: 0.3486s, Total: 5.3771s
Training complete.
Training complete.
Training complete.
Training complete.

[Epoch 1] Average Timing over 20 Iterations:
Training complete.
Forward: 1.8912s, Backward: 3.0930s, Optimizer: 0.1963s, Total: 5.1805s
Training complete.
Training complete.
Training complete.
